<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>url_variables.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="URLVariables.html">URLVariables</a><ul class='methods'><li data-type='method'><a href="URLVariables.html#decode">decode</a></li><li data-type='method'><a href="URLVariables.html#toString">toString</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">url_variables.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @author Tzuyang Tsai (shiyou0130011)
 * @license Apache-2.0
 */
 
/**
 * @typedef {(String|Object)} Query
 * A query string, an url or an object
 * @example "a=1&amp;b=2&amp;c=3"	// query string
 * @example {"a":1, "b":2, "c":3}	// object
 * @example {"a":[1, 2], "b":2, "c":3}	// object
 * @example "http://example.com"	// an url without queries
 * @example "http://example.com?a=1&amp;b=2&amp;c=3"	// an url with queries
 */

/**
 * @constructor
 * @param variables {Query}
 */
function URLVariables(variables) {
	if (!(this instanceof URLVariables)) {
		return new URLVariables(variables)
	}
	this.decode(variables)
}

/**
 * Converts the url string or object to the specified URLVariables object.
 * @param {Query}
 * @return {URLVariables}	this
 * 
 * @example 
 * var u = new URLVariables;
 * u.decode("a=1&amp;b=2&amp;c=3&amp;a=2")	// u will be {"a":["1","2"],"b":["2"],"c":["3"]}
 * @example 
 * var u = new URLVariables;
 * u.decode({a: [1, 2], b: 2, c: 3})	// u will be {"a":["1","2"],"b":["2"],"c":["3"]}
 */
URLVariables.prototype.decode = function (source) {
	switch (typeof source) {
		case "string":
			var url = source
			var urlvar 
			if(url.indexOf("?") >= 0){
				url = url.substr(url.indexOf("?") + 1) 
			}else if(url.indexOf("=") &lt; 0){
				url = ""
			}
			
			if(url.length > 0){
				urlvar = url.split("&amp;")
			}else{
				urlvar = {}
			}
			
			
			for (var i in urlvar) {
				var data = urlvar[i].split("=")
				var name = data[0] === undefined? "": decodeURIComponent(data[0]), 
				    value = data[1] === undefined? "": decodeURIComponent(data[1])
				if (!(this[name] instanceof Array)) {
					if (this[name]) {
						this[name] = [this[name]]
					}
					this[name] = [value]
					
				}else{
					this[name].push(value)
				}
			}
			break
		case "object":
			for(var i in source) {
				if (this[i] != undefined) {
					if (!(this[i] instanceof Array)) {
						this[i] = [this[i]]
					}
				}else{
					this[i] = []
				}
				
				if (source[i] instanceof Array) {
					[].push.apply(this[i], source[i])
				}else{
					this[i].push(source[i])
				}
			}
	}
	return this
}

/**
 * @return {String} The string containing all variables, in the MIME content encoding &lt;i>application/x-www-form-urlencoded&lt;/i>.
 */
URLVariables.prototype.toString = function () {
	var urlvar_keys = []
	for(var i in this) {
		if (typeof this[i] != "function" &amp;&amp; !URLVariables.prototype[i])
			urlvar_keys.push(i)
	}
	urlvar_keys.sort()

	var l = []
	for (i in urlvar_keys) {
		var key = urlvar_keys[i]
		if (!(this[key] instanceof Array)){
			this[key] = [this[key]]
		}
		
		this[key].sort()
		this[key].forEach(function(val, index, array) {
			l.push(encodeURIComponent(key) + "=" + encodeURIComponent(val))
		})
	}
	return l.join("&amp;")
}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Jun 29 2016 16:26:58 GMT+0800 (台北標準時間) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
